{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "175d8dfe-3661-4d2f-a5fd-4ead85cce6e7",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import streamlit as st\n",
    "from sklearn.ensemble import IsolationForest\n",
    "from sklearn.preprocessing import StandardScaler"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "0bb3d5a0-8d06-4b8a-8480-3689906c3b34",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Shape of the dataset: (2512, 16)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TransactionID</th>\n",
       "      <th>AccountID</th>\n",
       "      <th>TransactionAmount</th>\n",
       "      <th>TransactionDate</th>\n",
       "      <th>TransactionType</th>\n",
       "      <th>Location</th>\n",
       "      <th>DeviceID</th>\n",
       "      <th>IP Address</th>\n",
       "      <th>MerchantID</th>\n",
       "      <th>Channel</th>\n",
       "      <th>CustomerAge</th>\n",
       "      <th>CustomerOccupation</th>\n",
       "      <th>TransactionDuration</th>\n",
       "      <th>LoginAttempts</th>\n",
       "      <th>AccountBalance</th>\n",
       "      <th>PreviousTransactionDate</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>TX000001</td>\n",
       "      <td>AC00128</td>\n",
       "      <td>14.09</td>\n",
       "      <td>2023-04-11 16:29:14</td>\n",
       "      <td>Debit</td>\n",
       "      <td>San Diego</td>\n",
       "      <td>D000380</td>\n",
       "      <td>162.198.218.92</td>\n",
       "      <td>M015</td>\n",
       "      <td>ATM</td>\n",
       "      <td>70</td>\n",
       "      <td>Doctor</td>\n",
       "      <td>81</td>\n",
       "      <td>1</td>\n",
       "      <td>5112.21</td>\n",
       "      <td>2024-11-04 08:08:08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>TX000002</td>\n",
       "      <td>AC00455</td>\n",
       "      <td>376.24</td>\n",
       "      <td>2023-06-27 16:44:19</td>\n",
       "      <td>Debit</td>\n",
       "      <td>Houston</td>\n",
       "      <td>D000051</td>\n",
       "      <td>13.149.61.4</td>\n",
       "      <td>M052</td>\n",
       "      <td>ATM</td>\n",
       "      <td>68</td>\n",
       "      <td>Doctor</td>\n",
       "      <td>141</td>\n",
       "      <td>1</td>\n",
       "      <td>13758.91</td>\n",
       "      <td>2024-11-04 08:09:35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>TX000003</td>\n",
       "      <td>AC00019</td>\n",
       "      <td>126.29</td>\n",
       "      <td>2023-07-10 18:16:08</td>\n",
       "      <td>Debit</td>\n",
       "      <td>Mesa</td>\n",
       "      <td>D000235</td>\n",
       "      <td>215.97.143.157</td>\n",
       "      <td>M009</td>\n",
       "      <td>Online</td>\n",
       "      <td>19</td>\n",
       "      <td>Student</td>\n",
       "      <td>56</td>\n",
       "      <td>1</td>\n",
       "      <td>1122.35</td>\n",
       "      <td>2024-11-04 08:07:04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>TX000004</td>\n",
       "      <td>AC00070</td>\n",
       "      <td>184.50</td>\n",
       "      <td>2023-05-05 16:32:11</td>\n",
       "      <td>Debit</td>\n",
       "      <td>Raleigh</td>\n",
       "      <td>D000187</td>\n",
       "      <td>200.13.225.150</td>\n",
       "      <td>M002</td>\n",
       "      <td>Online</td>\n",
       "      <td>26</td>\n",
       "      <td>Student</td>\n",
       "      <td>25</td>\n",
       "      <td>1</td>\n",
       "      <td>8569.06</td>\n",
       "      <td>2024-11-04 08:09:06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>TX000005</td>\n",
       "      <td>AC00411</td>\n",
       "      <td>13.45</td>\n",
       "      <td>2023-10-16 17:51:24</td>\n",
       "      <td>Credit</td>\n",
       "      <td>Atlanta</td>\n",
       "      <td>D000308</td>\n",
       "      <td>65.164.3.100</td>\n",
       "      <td>M091</td>\n",
       "      <td>Online</td>\n",
       "      <td>26</td>\n",
       "      <td>Student</td>\n",
       "      <td>198</td>\n",
       "      <td>1</td>\n",
       "      <td>7429.40</td>\n",
       "      <td>2024-11-04 08:06:39</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  TransactionID AccountID  TransactionAmount      TransactionDate  \\\n",
       "0      TX000001   AC00128              14.09  2023-04-11 16:29:14   \n",
       "1      TX000002   AC00455             376.24  2023-06-27 16:44:19   \n",
       "2      TX000003   AC00019             126.29  2023-07-10 18:16:08   \n",
       "3      TX000004   AC00070             184.50  2023-05-05 16:32:11   \n",
       "4      TX000005   AC00411              13.45  2023-10-16 17:51:24   \n",
       "\n",
       "  TransactionType   Location DeviceID      IP Address MerchantID Channel  \\\n",
       "0           Debit  San Diego  D000380  162.198.218.92       M015     ATM   \n",
       "1           Debit    Houston  D000051     13.149.61.4       M052     ATM   \n",
       "2           Debit       Mesa  D000235  215.97.143.157       M009  Online   \n",
       "3           Debit    Raleigh  D000187  200.13.225.150       M002  Online   \n",
       "4          Credit    Atlanta  D000308    65.164.3.100       M091  Online   \n",
       "\n",
       "   CustomerAge CustomerOccupation  TransactionDuration  LoginAttempts  \\\n",
       "0           70             Doctor                   81              1   \n",
       "1           68             Doctor                  141              1   \n",
       "2           19            Student                   56              1   \n",
       "3           26            Student                   25              1   \n",
       "4           26            Student                  198              1   \n",
       "\n",
       "   AccountBalance PreviousTransactionDate  \n",
       "0         5112.21     2024-11-04 08:08:08  \n",
       "1        13758.91     2024-11-04 08:09:35  \n",
       "2         1122.35     2024-11-04 08:07:04  \n",
       "3         8569.06     2024-11-04 08:09:06  \n",
       "4         7429.40     2024-11-04 08:06:39  "
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "st.title(\"Anamoly detection using IsolationForest\")\n",
    "df = pd.read_csv('bank_transactions.csv') \n",
    "st.write(df)\n",
    "# Display basic information about the dataset\n",
    "print(\"Shape of the dataset:\", df.shape)\n",
    "display(df.head())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "c1efd36e-4750-4d48-94de-6db04cd36e9a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "TransactionID              0\n",
       "AccountID                  0\n",
       "TransactionAmount          0\n",
       "TransactionDate            0\n",
       "TransactionType            0\n",
       "Location                   0\n",
       "DeviceID                   0\n",
       "IP Address                 0\n",
       "MerchantID                 0\n",
       "Channel                    0\n",
       "CustomerAge                0\n",
       "CustomerOccupation         0\n",
       "TransactionDuration        0\n",
       "LoginAttempts              0\n",
       "AccountBalance             0\n",
       "PreviousTransactionDate    0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "1dd8dda6-b3c7-4ecc-b7bc-bceb0ebe7a6a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TransactionAmount</th>\n",
       "      <th>CustomerAge</th>\n",
       "      <th>TransactionDuration</th>\n",
       "      <th>LoginAttempts</th>\n",
       "      <th>AccountBalance</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>2512.000000</td>\n",
       "      <td>2512.000000</td>\n",
       "      <td>2512.000000</td>\n",
       "      <td>2512.000000</td>\n",
       "      <td>2512.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>297.593778</td>\n",
       "      <td>44.673965</td>\n",
       "      <td>119.643312</td>\n",
       "      <td>1.124602</td>\n",
       "      <td>5114.302966</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>291.946243</td>\n",
       "      <td>17.792198</td>\n",
       "      <td>69.963757</td>\n",
       "      <td>0.602662</td>\n",
       "      <td>3900.942499</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>0.260000</td>\n",
       "      <td>18.000000</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>101.250000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>81.885000</td>\n",
       "      <td>27.000000</td>\n",
       "      <td>63.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1504.370000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>211.140000</td>\n",
       "      <td>45.000000</td>\n",
       "      <td>112.500000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>4735.510000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>414.527500</td>\n",
       "      <td>59.000000</td>\n",
       "      <td>161.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>7678.820000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>1919.110000</td>\n",
       "      <td>80.000000</td>\n",
       "      <td>300.000000</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>14977.990000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       TransactionAmount  CustomerAge  TransactionDuration  LoginAttempts  \\\n",
       "count        2512.000000  2512.000000          2512.000000    2512.000000   \n",
       "mean          297.593778    44.673965           119.643312       1.124602   \n",
       "std           291.946243    17.792198            69.963757       0.602662   \n",
       "min             0.260000    18.000000            10.000000       1.000000   \n",
       "25%            81.885000    27.000000            63.000000       1.000000   \n",
       "50%           211.140000    45.000000           112.500000       1.000000   \n",
       "75%           414.527500    59.000000           161.000000       1.000000   \n",
       "max          1919.110000    80.000000           300.000000       5.000000   \n",
       "\n",
       "       AccountBalance  \n",
       "count     2512.000000  \n",
       "mean      5114.302966  \n",
       "std       3900.942499  \n",
       "min        101.250000  \n",
       "25%       1504.370000  \n",
       "50%       4735.510000  \n",
       "75%       7678.820000  \n",
       "max      14977.990000  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "a240af4c-a5cc-45ca-9132-3f1d0338c24c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 2512 entries, 0 to 2511\n",
      "Data columns (total 16 columns):\n",
      " #   Column                   Non-Null Count  Dtype  \n",
      "---  ------                   --------------  -----  \n",
      " 0   TransactionID            2512 non-null   object \n",
      " 1   AccountID                2512 non-null   object \n",
      " 2   TransactionAmount        2512 non-null   float64\n",
      " 3   TransactionDate          2512 non-null   object \n",
      " 4   TransactionType          2512 non-null   object \n",
      " 5   Location                 2512 non-null   object \n",
      " 6   DeviceID                 2512 non-null   object \n",
      " 7   IP Address               2512 non-null   object \n",
      " 8   MerchantID               2512 non-null   object \n",
      " 9   Channel                  2512 non-null   object \n",
      " 10  CustomerAge              2512 non-null   int64  \n",
      " 11  CustomerOccupation       2512 non-null   object \n",
      " 12  TransactionDuration      2512 non-null   int64  \n",
      " 13  LoginAttempts            2512 non-null   int64  \n",
      " 14  AccountBalance           2512 non-null   float64\n",
      " 15  PreviousTransactionDate  2512 non-null   object \n",
      "dtypes: float64(2), int64(3), object(11)\n",
      "memory usage: 314.1+ KB\n"
     ]
    }
   ],
   "source": [
    "df.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "4be81618-53e0-4b81-84d2-fc643c8a0543",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[-9.71275470e-01, -5.52443263e-01, -5.36635052e-04,\n",
       "        -2.06793649e-01],\n",
       "       [ 2.69439606e-01,  3.05314366e-01,  2.21647159e+00,\n",
       "        -2.06793649e-01],\n",
       "       [-5.86881623e-01, -9.09842275e-01, -1.02353413e+00,\n",
       "        -2.06793649e-01],\n",
       "       ...,\n",
       "       [-9.21461864e-01,  3.76794169e-01, -4.43928023e-01,\n",
       "        -2.06793649e-01],\n",
       "       [-3.82419727e-01, -1.43879281e+00, -8.55705373e-01,\n",
       "        -2.06793649e-01],\n",
       "       [-1.86762574e-01, -3.80891737e-01, -1.27765152e+00,\n",
       "        -2.06793649e-01]])"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "features = ['TransactionAmount', 'TransactionDuration', 'AccountBalance', 'LoginAttempts']  # Modify as needed\n",
    "X = df[features].copy()\n",
    "\n",
    "X = X.fillna(X.mean())\n",
    "\n",
    "# Standardize the features \n",
    "scaler = StandardScaler()\n",
    "X_scaled = scaler.fit_transform(X)\n",
    "st.write(X_scaled)\n",
    "# Fit the Isolation Forest model\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "e0056e5e-925c-47b8-b35b-cbf28f8d3376",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       0.184358\n",
       "1       0.097301\n",
       "2       0.178514\n",
       "3       0.150973\n",
       "4       0.142493\n",
       "          ...   \n",
       "2507    0.044795\n",
       "2508    0.143192\n",
       "2509    0.175343\n",
       "2510    0.134966\n",
       "2511    0.156590\n",
       "Name: AnomalyScore, Length: 2512, dtype: float64"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "iso_forest = IsolationForest(n_estimators=100, contamination=0.05, random_state=42)\n",
    "iso_forest.fit(X_scaled)\n",
    "\n",
    "# Predict anomalies\n",
    "df['AnomalyScore'] = iso_forest.decision_function(X_scaled)\n",
    "df['IsAnomaly'] = iso_forest.predict(X_scaled)  \n",
    "df['AnomalyScore']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "bcc31581-5e25-4512-a49b-4eb52d69fb56",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TransactionID</th>\n",
       "      <th>AccountID</th>\n",
       "      <th>TransactionAmount</th>\n",
       "      <th>TransactionDate</th>\n",
       "      <th>TransactionType</th>\n",
       "      <th>Location</th>\n",
       "      <th>DeviceID</th>\n",
       "      <th>IP Address</th>\n",
       "      <th>MerchantID</th>\n",
       "      <th>Channel</th>\n",
       "      <th>CustomerAge</th>\n",
       "      <th>CustomerOccupation</th>\n",
       "      <th>TransactionDuration</th>\n",
       "      <th>LoginAttempts</th>\n",
       "      <th>AccountBalance</th>\n",
       "      <th>PreviousTransactionDate</th>\n",
       "      <th>AnomalyScore</th>\n",
       "      <th>IsAnomaly</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>TX000027</td>\n",
       "      <td>AC00441</td>\n",
       "      <td>246.93</td>\n",
       "      <td>2023-04-17 16:37:01</td>\n",
       "      <td>Debit</td>\n",
       "      <td>Miami</td>\n",
       "      <td>D000046</td>\n",
       "      <td>55.154.161.250</td>\n",
       "      <td>M029</td>\n",
       "      <td>ATM</td>\n",
       "      <td>23</td>\n",
       "      <td>Student</td>\n",
       "      <td>158</td>\n",
       "      <td>5</td>\n",
       "      <td>673.35</td>\n",
       "      <td>2024-11-04 08:11:38</td>\n",
       "      <td>-0.075150</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>TX000033</td>\n",
       "      <td>AC00060</td>\n",
       "      <td>396.45</td>\n",
       "      <td>2023-09-25 16:26:00</td>\n",
       "      <td>Debit</td>\n",
       "      <td>New York</td>\n",
       "      <td>D000621</td>\n",
       "      <td>133.67.250.163</td>\n",
       "      <td>M007</td>\n",
       "      <td>ATM</td>\n",
       "      <td>49</td>\n",
       "      <td>Engineer</td>\n",
       "      <td>168</td>\n",
       "      <td>3</td>\n",
       "      <td>9690.15</td>\n",
       "      <td>2024-11-04 08:11:13</td>\n",
       "      <td>-0.014181</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>85</th>\n",
       "      <td>TX000086</td>\n",
       "      <td>AC00098</td>\n",
       "      <td>1340.19</td>\n",
       "      <td>2023-09-29 17:22:10</td>\n",
       "      <td>Credit</td>\n",
       "      <td>Austin</td>\n",
       "      <td>D000574</td>\n",
       "      <td>165.114.224.47</td>\n",
       "      <td>M012</td>\n",
       "      <td>Online</td>\n",
       "      <td>54</td>\n",
       "      <td>Engineer</td>\n",
       "      <td>30</td>\n",
       "      <td>1</td>\n",
       "      <td>8654.28</td>\n",
       "      <td>2024-11-04 08:06:53</td>\n",
       "      <td>-0.018206</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>91</th>\n",
       "      <td>TX000092</td>\n",
       "      <td>AC00310</td>\n",
       "      <td>223.85</td>\n",
       "      <td>2023-10-02 16:36:10</td>\n",
       "      <td>Debit</td>\n",
       "      <td>Kansas City</td>\n",
       "      <td>D000481</td>\n",
       "      <td>133.223.159.151</td>\n",
       "      <td>M009</td>\n",
       "      <td>ATM</td>\n",
       "      <td>53</td>\n",
       "      <td>Engineer</td>\n",
       "      <td>55</td>\n",
       "      <td>4</td>\n",
       "      <td>2929.91</td>\n",
       "      <td>2024-11-04 08:08:01</td>\n",
       "      <td>-0.029888</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>146</th>\n",
       "      <td>TX000147</td>\n",
       "      <td>AC00385</td>\n",
       "      <td>973.39</td>\n",
       "      <td>2023-08-30 17:23:20</td>\n",
       "      <td>Debit</td>\n",
       "      <td>Sacramento</td>\n",
       "      <td>D000292</td>\n",
       "      <td>202.194.199.70</td>\n",
       "      <td>M026</td>\n",
       "      <td>Branch</td>\n",
       "      <td>77</td>\n",
       "      <td>Retired</td>\n",
       "      <td>296</td>\n",
       "      <td>1</td>\n",
       "      <td>2042.22</td>\n",
       "      <td>2024-11-04 08:11:44</td>\n",
       "      <td>-0.016904</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2403</th>\n",
       "      <td>TX002404</td>\n",
       "      <td>AC00111</td>\n",
       "      <td>1493.00</td>\n",
       "      <td>2023-06-07 17:05:41</td>\n",
       "      <td>Debit</td>\n",
       "      <td>Colorado Springs</td>\n",
       "      <td>D000344</td>\n",
       "      <td>136.162.111.135</td>\n",
       "      <td>M096</td>\n",
       "      <td>ATM</td>\n",
       "      <td>69</td>\n",
       "      <td>Retired</td>\n",
       "      <td>151</td>\n",
       "      <td>1</td>\n",
       "      <td>1619.16</td>\n",
       "      <td>2024-11-04 08:07:07</td>\n",
       "      <td>-0.010979</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2414</th>\n",
       "      <td>TX002415</td>\n",
       "      <td>AC00028</td>\n",
       "      <td>1664.33</td>\n",
       "      <td>2023-09-25 17:11:19</td>\n",
       "      <td>Debit</td>\n",
       "      <td>San Antonio</td>\n",
       "      <td>D000072</td>\n",
       "      <td>116.106.207.139</td>\n",
       "      <td>M064</td>\n",
       "      <td>Branch</td>\n",
       "      <td>18</td>\n",
       "      <td>Student</td>\n",
       "      <td>65</td>\n",
       "      <td>1</td>\n",
       "      <td>1588.31</td>\n",
       "      <td>2024-11-04 08:07:07</td>\n",
       "      <td>-0.014229</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2423</th>\n",
       "      <td>TX002424</td>\n",
       "      <td>AC00340</td>\n",
       "      <td>332.06</td>\n",
       "      <td>2023-06-21 16:38:54</td>\n",
       "      <td>Debit</td>\n",
       "      <td>Seattle</td>\n",
       "      <td>D000365</td>\n",
       "      <td>94.37.250.128</td>\n",
       "      <td>M086</td>\n",
       "      <td>ATM</td>\n",
       "      <td>29</td>\n",
       "      <td>Doctor</td>\n",
       "      <td>221</td>\n",
       "      <td>4</td>\n",
       "      <td>11826.52</td>\n",
       "      <td>2024-11-04 08:06:23</td>\n",
       "      <td>-0.081369</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2445</th>\n",
       "      <td>TX002446</td>\n",
       "      <td>AC00439</td>\n",
       "      <td>403.01</td>\n",
       "      <td>2023-09-04 17:32:35</td>\n",
       "      <td>Debit</td>\n",
       "      <td>Washington</td>\n",
       "      <td>D000677</td>\n",
       "      <td>223.32.70.156</td>\n",
       "      <td>M029</td>\n",
       "      <td>Online</td>\n",
       "      <td>63</td>\n",
       "      <td>Doctor</td>\n",
       "      <td>286</td>\n",
       "      <td>3</td>\n",
       "      <td>10513.52</td>\n",
       "      <td>2024-11-04 08:09:32</td>\n",
       "      <td>-0.070488</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2457</th>\n",
       "      <td>TX002458</td>\n",
       "      <td>AC00315</td>\n",
       "      <td>79.92</td>\n",
       "      <td>2023-02-06 17:32:11</td>\n",
       "      <td>Debit</td>\n",
       "      <td>Miami</td>\n",
       "      <td>D000193</td>\n",
       "      <td>42.3.3.101</td>\n",
       "      <td>M003</td>\n",
       "      <td>ATM</td>\n",
       "      <td>44</td>\n",
       "      <td>Engineer</td>\n",
       "      <td>274</td>\n",
       "      <td>2</td>\n",
       "      <td>9138.76</td>\n",
       "      <td>2024-11-04 08:09:14</td>\n",
       "      <td>-0.007597</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>126 rows Ã— 18 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     TransactionID AccountID  TransactionAmount      TransactionDate  \\\n",
       "26        TX000027   AC00441             246.93  2023-04-17 16:37:01   \n",
       "32        TX000033   AC00060             396.45  2023-09-25 16:26:00   \n",
       "85        TX000086   AC00098            1340.19  2023-09-29 17:22:10   \n",
       "91        TX000092   AC00310             223.85  2023-10-02 16:36:10   \n",
       "146       TX000147   AC00385             973.39  2023-08-30 17:23:20   \n",
       "...            ...       ...                ...                  ...   \n",
       "2403      TX002404   AC00111            1493.00  2023-06-07 17:05:41   \n",
       "2414      TX002415   AC00028            1664.33  2023-09-25 17:11:19   \n",
       "2423      TX002424   AC00340             332.06  2023-06-21 16:38:54   \n",
       "2445      TX002446   AC00439             403.01  2023-09-04 17:32:35   \n",
       "2457      TX002458   AC00315              79.92  2023-02-06 17:32:11   \n",
       "\n",
       "     TransactionType          Location DeviceID       IP Address MerchantID  \\\n",
       "26             Debit             Miami  D000046   55.154.161.250       M029   \n",
       "32             Debit          New York  D000621   133.67.250.163       M007   \n",
       "85            Credit            Austin  D000574   165.114.224.47       M012   \n",
       "91             Debit       Kansas City  D000481  133.223.159.151       M009   \n",
       "146            Debit        Sacramento  D000292   202.194.199.70       M026   \n",
       "...              ...               ...      ...              ...        ...   \n",
       "2403           Debit  Colorado Springs  D000344  136.162.111.135       M096   \n",
       "2414           Debit       San Antonio  D000072  116.106.207.139       M064   \n",
       "2423           Debit           Seattle  D000365    94.37.250.128       M086   \n",
       "2445           Debit        Washington  D000677    223.32.70.156       M029   \n",
       "2457           Debit             Miami  D000193       42.3.3.101       M003   \n",
       "\n",
       "     Channel  CustomerAge CustomerOccupation  TransactionDuration  \\\n",
       "26       ATM           23            Student                  158   \n",
       "32       ATM           49           Engineer                  168   \n",
       "85    Online           54           Engineer                   30   \n",
       "91       ATM           53           Engineer                   55   \n",
       "146   Branch           77            Retired                  296   \n",
       "...      ...          ...                ...                  ...   \n",
       "2403     ATM           69            Retired                  151   \n",
       "2414  Branch           18            Student                   65   \n",
       "2423     ATM           29             Doctor                  221   \n",
       "2445  Online           63             Doctor                  286   \n",
       "2457     ATM           44           Engineer                  274   \n",
       "\n",
       "      LoginAttempts  AccountBalance PreviousTransactionDate  AnomalyScore  \\\n",
       "26                5          673.35     2024-11-04 08:11:38     -0.075150   \n",
       "32                3         9690.15     2024-11-04 08:11:13     -0.014181   \n",
       "85                1         8654.28     2024-11-04 08:06:53     -0.018206   \n",
       "91                4         2929.91     2024-11-04 08:08:01     -0.029888   \n",
       "146               1         2042.22     2024-11-04 08:11:44     -0.016904   \n",
       "...             ...             ...                     ...           ...   \n",
       "2403              1         1619.16     2024-11-04 08:07:07     -0.010979   \n",
       "2414              1         1588.31     2024-11-04 08:07:07     -0.014229   \n",
       "2423              4        11826.52     2024-11-04 08:06:23     -0.081369   \n",
       "2445              3        10513.52     2024-11-04 08:09:32     -0.070488   \n",
       "2457              2         9138.76     2024-11-04 08:09:14     -0.007597   \n",
       "\n",
       "      IsAnomaly  \n",
       "26           -1  \n",
       "32           -1  \n",
       "85           -1  \n",
       "91           -1  \n",
       "146          -1  \n",
       "...         ...  \n",
       "2403         -1  \n",
       "2414         -1  \n",
       "2423         -1  \n",
       "2445         -1  \n",
       "2457         -1  \n",
       "\n",
       "[126 rows x 18 columns]"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[df['IsAnomaly']==-1]"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:base] *",
   "language": "python",
   "name": "conda-base-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
